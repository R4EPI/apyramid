<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to {apyramid} • apyramid</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to {apyramid}">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">apyramid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Introduction to {apyramid}</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/R4EPI/apyramid">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to {apyramid}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R4EPI/apyramid/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<!--
NOTE: If you want to change anything here, please edit the files listed below.
-->
<p>The goal of {apyramid} is to provide a quick method for visualizing census data stratified by age and one or two categorical variables (e.g. gender and health status). This is a product of the R4EPIs project; learn more at <a href="https://r4epis.netlify.com" class="uri">https://r4epis.netlify.com</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install {apyramid} from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"apyramid"</span>)</a></code></pre></div>
<p>You can also install the development version from GitHub using the {remotes} package:</p>
<p>The most recent released code is guaranteed to be stable:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># install.packages("remotes")</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"R4EPI/apyramid@*release"</span>) </a></code></pre></div>
<p>Otherwise, you can install the bleeding-edge version like so:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># install.packages("remotes")</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"R4EPI/apyramid"</span>) </a></code></pre></div>
<p>The {apyramid} package was primarily designed for quick visualisation of un-aggregated linelist data in field epidemiological situations. It has one available function:</p>
<ul>
<li>
<code><a href="../reference/age_pyramid.html">age_pyramid()</a></code> returns age pyramid visualizations of linelist, survey, or pre-aggregated census data as a <code>ggplot</code> object.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"apyramid"</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggplot2"</span>)   <span class="co"># load ggplot2 to control plot aesthetics</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"outbreaks"</span>) <span class="co"># load the outbreaks package for linelist data</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">old_theme &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>(<span class="dt">base_size =</span> <span class="dv">18</span>))</a></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>We can demonstrate plotting of un-aggregated data with the <code>fluH7N9_china_2013</code> data set in the {outbreaks} package that records 136 cases of Influenza A H7N9 in China in 2013 (source: <a href="https://doi.org/10.5061/dryad.2g43n" class="uri">https://doi.org/10.5061/dryad.2g43n</a>)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">flu &lt;-<span class="st"> </span>outbreaks<span class="op">::</span>fluH7N9_china_<span class="dv">2013</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># data preparation (create age groups from ages)</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">autocut &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="kw"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(x, <span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span>(x), <span class="dt">right =</span> <span class="ot">TRUE</span>, <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">flu<span class="op">$</span>age_group &lt;-<span class="st"> </span><span class="kw">autocut</span>(<span class="kw"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(flu<span class="op">$</span>age))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(flu<span class="op">$</span>gender) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(flu)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;   case_id date_of_onset date_of_hospitalisation date_of_outcome outcome gender</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; 1       1    2013-02-19                    &lt;NA&gt;      2013-03-04   Death   Male</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; 2       2    2013-02-27              2013-03-03      2013-03-10   Death   Male</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; 3       3    2013-03-09              2013-03-19      2013-04-09   Death Female</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 4       4    2013-03-19              2013-03-27            &lt;NA&gt;    &lt;NA&gt; Female</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; 5       5    2013-03-19              2013-03-30      2013-05-15 Recover Female</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; 6       6    2013-03-21              2013-03-28      2013-04-26   Death Female</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;   age province age_group</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; 1  87 Shanghai   (50,60]</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; 2  27 Shanghai    [0,10]</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; 3  35    Anhui   (10,20]</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; 4  45  Jiangsu   (10,20]</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; 5  48  Jiangsu   (10,20]</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt; 6  32  Jiangsu    [0,10]</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">flup &lt;-<span class="st"> </span><span class="kw"><a href="../reference/age_pyramid.html">age_pyramid</a></span>(flu, age_group, <span class="dt">split_by =</span> gender)</a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt; Warning: 2 missing rows were removed (0 values from `age_group` and 2 values</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt; from `gender`).</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28">flup</a></code></pre></div>
<p><img src="man/figures/README-flu-1.png" width="100%"></p>
<p>Since the result is a ggplot2 object, it can be customized like one:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">flup <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html">scale_fill_grey</a></span>(<span class="dt">guide =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span>(<span class="dt">order =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size =</span> <span class="dv">18</span>, <span class="dt">family =</span> <span class="st">"serif"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">panel.background =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(<span class="dt">fill =</span> <span class="st">"#ccffff"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">plot.background =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(<span class="dt">fill =</span> <span class="st">"#ffffcc"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.background =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">    <span class="dt">x       =</span> <span class="st">"Age group (years)"</span>,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">    <span class="dt">y       =</span> <span class="st">"Number of cases"</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">    <span class="dt">fill    =</span> <span class="st">"Gender"</span>,</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">    <span class="dt">title   =</span> <span class="st">"136 cases of influenza A H7N9 in China"</span>,</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">    <span class="dt">caption =</span> <span class="st">"Source: https://doi.org/10.5061/dryad.2g43n"</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  )</a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; will replace the existing scale.</span></a></code></pre></div>
<p><img src="man/figures/README-flu2-1.png" width="100%"></p>
<p>One of the advantages of {apyramid} is that it will adjust to account for non-binary categorical variables. For example, in the flu data set, there are two cases with no gender reported. If we set <code>na.rm = FALSE</code>, we can the age distribution of these two cases:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/age_pyramid.html">age_pyramid</a></span>(flu, age_group, <span class="dt">split_by =</span> gender, <span class="dt">na.rm =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="man/figures/README-flu3-1.png" width="100%"></p>
</div>
<div id="pre-aggregated-data" class="section level2">
<h2 class="hasAnchor">
<a href="#pre-aggregated-data" class="anchor"></a>Pre-aggregated data</h2>
<p>{apyramid} can also be used to visualize pre-aggregated data. This example is the US census data from 2018:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">us_labels &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="dt">x =</span> <span class="st">"Age group"</span>, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="dt">y =</span> <span class="st">"Thousands of people"</span>, </a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  <span class="dt">title =</span> <span class="st">"US Cenus Data 2018"</span>,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  <span class="dt">caption =</span> <span class="st">"source: https://census.gov/data/tables/2018/demo/age-and-sex/2018-age-sex-composition.html"</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(us_<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">us_<span class="dv">2018</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; # A tibble: 36 x 4</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;    age   gender count percent</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt;  &lt;int&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  1 &lt;5    male   10193     6.4</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  2 &lt;5    female  9736     5.9</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  3 5-9   male   10338     6.5</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;  4 5-9   female  9905     6  </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;  5 10-14 male   10607     6.7</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt;  6 10-14 female 10204     6.2</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;  7 15-19 male   10617     6.7</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt;  8 15-19 female 10291     6.2</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt;  9 20-24 male   10809     6.8</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt; 10 20-24 female 10625     6.4</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; # … with 26 more rows</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/age_pyramid.html">age_pyramid</a></span>(us_<span class="dv">2018</span>, <span class="dt">age_group =</span> age, <span class="dt">split_by =</span> gender, <span class="dt">count =</span> count)</a>
<a class="sourceLine" id="cb8-25" data-line-number="25">p <span class="op">+</span><span class="st"> </span>us_labels</a></code></pre></div>
<p><img src="man/figures/README-us2018-1.png" width="100%"></p>
<p>You can also use another factor to split the data:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(us_ins_<span class="dv">2018</span>) <span class="co"># stratified by gender and health insurance status</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(us_gen_<span class="dv">2018</span>) <span class="co"># stratified by gender and generational status</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">p_ins &lt;-<span class="st"> </span><span class="kw"><a href="../reference/age_pyramid.html">age_pyramid</a></span>(us_ins_<span class="dv">2018</span>, <span class="dt">age_group =</span> age, <span class="dt">split_by =</span> gender, <span class="dt">stack_by =</span> insured, <span class="dt">count =</span> count)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">p_gen &lt;-<span class="st"> </span><span class="kw"><a href="../reference/age_pyramid.html">age_pyramid</a></span>(us_gen_<span class="dv">2018</span>, <span class="dt">age_group =</span> age, <span class="dt">split_by =</span> gender, <span class="dt">stack_by =</span> generation, <span class="dt">count =</span> count)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">p_ins <span class="op">+</span><span class="st"> </span>us_labels</a></code></pre></div>
<p><img src="man/figures/README-us2018_factor-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">p_gen <span class="op">+</span><span class="st"> </span>us_labels</a></code></pre></div>
<p><img src="man/figures/README-us2018_factor-2.png" width="100%"></p>
</div>
<div id="survey-data" class="section level2">
<h2 class="hasAnchor">
<a href="#survey-data" class="anchor"></a>Survey Data</h2>
<p>Beyond that, survey data can be incorporated with the help of srvyr. Note that while it will show the weighted counts, it will not show the confidence intervals as that highly depends on the appropriate choice of CI estimator. This is meant as more of quick visualization tool for EDA.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(srvyr, <span class="dt">warn.conflicts =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(api, <span class="dt">package =</span> <span class="st">"survey"</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">dstrata &lt;-<span class="st"> </span>apistrat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/srvyr/man/dplyr_single.html">mutate</a></span>(<span class="dt">apicat =</span> <span class="kw"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(api00, <span class="kw"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span>(api00), <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">right =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/srvyr/man/as_survey_design.html">as_survey_design</a></span>(<span class="dt">strata =</span> stype, <span class="dt">weights =</span> pw)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"> </a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="kw"><a href="../reference/age_pyramid.html">age_pyramid</a></span>(dstrata, apicat, <span class="dt">split_by =</span> stype)</a></code></pre></div>
<p><img src="man/figures/README-srvyr-1.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span>(old_theme)</a></code></pre></div>
<div id="related-work" class="section level3">
<h3 class="hasAnchor">
<a href="#related-work" class="anchor"></a>Related work</h3>
<p>Population pyramids are common tools for epidemiologists and there are several solutions in R. To our knowledge, the {apyramid} package is the only one that allows for non-binary splitting variable.</p>
<ul>
<li><a href="https://cran.r-project.org/package=pyramid">pyramid::pyramid()</a></li>
<li><a href="https://cran.r-project.org/package=epiDisplay">epiDisplay::pyramid()</a></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#example">Example</a></li>
      <li><a href="#pre-aggregated-data">Pre-aggregated data</a></li>
      <li><a href="#survey-data">Survey Data</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zhian N. Kamvar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
